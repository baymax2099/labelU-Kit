import { CodeOutlined, SettingOutlined } from '@ant-design/icons';
import type { AnnotatorRef } from '@labelu/image-annotator-react';
import { Annotator as ImageAnnotator } from '@labelu/image-annotator-react';
import type { Annotator, ToolName } from '@labelu/image';
import { TOOL_NAMES } from '@labelu/image';
import type { TabsProps } from 'antd';
import CodeMirror from '@uiw/react-codemirror';
import { json } from '@codemirror/lang-json';
import { Button, Drawer, Form, Tabs } from 'antd';
import { useCallback, useMemo, useRef, useState } from 'react';
import Modal from 'antd/es/modal/Modal';
import message from 'antd/es/message';

import lineTemplate from '@/constant/templates/line.template';
import rectTemplate from '@/constant/templates/rect.template';
import polygonTemplate from '@/constant/templates/polygon.template';
import pointTemplate from '@/constant/templates/point.template';
import cuboidTemplate from '@/constant/templates/cuboid.template';
import tagTemplate from '@/constant/templates/tag.template';
import textTemplate from '@/constant/templates/text.template';
import FancyForm from '@/components/FancyForm';
import { add } from '@/components/FancyInput';
import { FancyAttributeList } from '@/components/CustomFancy/ListAttribute.fancy';
import { FancyCategoryAttribute } from '@/components/CustomFancy/CategoryAttribute.fancy';

add('list-attribute', FancyAttributeList);
add('category-attribute', FancyCategoryAttribute);

const templateMapping: Record<ToolName | 'tag' | 'text', any> = {
  line: lineTemplate,
  rect: rectTemplate,
  polygon: polygonTemplate,
  point: pointTemplate,
  cuboid: cuboidTemplate,
  tag: tagTemplate,
  text: textTemplate,
};

const presetSamples = [
  {
    url: import.meta.env.BASE_URL + 'sample-1.jpg',
    name: 'sample-1',
    id: 'sample-1',
    meta: {
      width: 1700,
      height: 957,
      rotate: 0,
    },
    data: {
      line: [],
      point: [],
      rect: [],
      polygon: [],
      cuboid: [
        {
          id: '0d11c430-d5f1-42e9-88d9-47c647bf2808',
          direction: 'front',
          front: {
            tl: {
              x: 811.1559139784947,
              y: 555.0456989247311,
            },
            tr: {
              x: 1039.6505376344087,
              y: 555.0456989247311,
            },
            br: {
              x: 1039.6505376344087,
              y: 797.25,
            },
            bl: {
              x: 811.1559139784947,
              y: 797.25,
            },
          },
          back: {
            tl: {
              x: 1028.6569283830393,
              y: 577.8951612903226,
            },
            tr: {
              x: 1188.1720430107528,
              y: 577.8951612903226,
            },
            br: {
              x: 1188.1720430107528,
              y: 746.9811827956988,
            },
            bl: {
              x: 1028.6569283830393,
              y: 746.9811827956988,
            },
          },
          label: 'suv',
          order: 1,
          tool: 'cuboid',
        },
        {
          id: '8a08651d-3dce-46fc-991b-f40cdcd08dc2',
          direction: 'front',
          front: {
            tl: {
              x: 1461.7968804057477,
              y: 629.6353935060331,
            },
            tr: {
              x: 1514.294708374816,
              y: 629.6353935060331,
            },
            br: {
              x: 1514.294708374816,
              y: 672.9669340519308,
            },
            bl: {
              x: 1461.7968804057477,
              y: 672.9669340519308,
            },
          },
          back: {
            tl: {
              x: 1477.4326803808365,
              y: 632.254332769796,
            },
            tr: {
              x: 1525.6037642865203,
              y: 632.254332769796,
            },
            br: {
              x: 1525.6037642865203,
              y: 672.0145925014715,
            },
            bl: {
              x: 1477.4326803808365,
              y: 672.0145925014715,
            },
          },
          label: 'car',
          order: 2,
          tool: 'cuboid',
        },
      ],
      text: [],
      tag: [],
    },
  },
  {
    url: import.meta.env.BASE_URL + 'sample-2.jpg',
    name: 'sample-2',
    id: 'sample-2',
    meta: {
      width: 1280,
      height: 800,
      rotate: 0,
    },
    data: {
      line: [],
      point: [],
      rect: [],
      polygon: [
        {
          id: 'f05e15df-765e-432f-bd42-de156c2f882d',
          type: 'spline',
          points: [
            {
              id: '6186610b-3f17-4c89-9dc7-1fd5aa4ea84d',
              x: 477.98529540777224,
              y: 135.34802331434923,
            },
            {
              id: '4185f4f5-ae24-4e96-8420-6edf153b20a8',
              x: 590.1075853265675,
              y: 209.50764814252872,
            },
            {
              id: 'f1b55b65-a1c0-47f2-b541-6bfc92bd5a1a',
              x: 488.5795275260836,
              y: 388.72674147729583,
            },
            {
              id: '439a0a18-7a71-4cad-a018-b56b38762f4e',
              x: 490.3452328791355,
              y: 420.5094378322299,
            },
            {
              id: '5104bb7a-e03b-4d1f-9041-b558ab49b223',
              x: 470.03962131903876,
              y: 420.5094378322299,
            },
            {
              id: '67597df9-cd96-4aac-aaba-e08756ac9906',
              x: 470.03962131903876,
              y: 396.6724155660294,
            },
            {
              id: 'da890335-c2d6-4793-8ae6-46b3167cfd76',
              x: 451.4997151119939,
              y: 357.82689779888767,
            },
            {
              id: '248302dc-8f39-452d-b9d5-12cff3fecb9f',
              x: 368.5115635185549,
              y: 246.58746055661848,
            },
            {
              id: '7bf3fb58-53f6-4dea-8b8f-1e4f1695f2bb',
              x: 394.9971438143333,
              y: 157.41934022749788,
            },
          ],
          controlPoints: [
            {
              x: 547.730656853322,
              y: 133.58231796129735,
            },
            {
              x: 590.9904380030933,
              y: 170.66213037538702,
            },
            {
              x: 584.8104692674118,
              y: 286.3158310002861,
            },
            {
              x: 488.5795275260836,
              y: 388.72674147729583,
            },
            {
              x: 488.5795275260836,
              y: 388.72674147729583,
            },
            {
              x: 490.3452328791355,
              y: 420.5094378322299,
            },
            {
              x: 490.3452328791355,
              y: 420.5094378322299,
            },
            {
              x: 470.03962131903876,
              y: 420.5094378322299,
            },
            {
              x: 470.03962131903876,
              y: 420.5094378322299,
            },
            {
              x: 470.03962131903876,
              y: 396.6724155660294,
            },
            {
              x: 470.03962131903876,
              y: 396.6724155660294,
            },
            {
              x: 451.4997151119939,
              y: 357.82689779888767,
            },
            {
              x: 451.4997151119939,
              y: 357.82689779888767,
            },
            {
              x: 374.6915322542365,
              y: 273.0730408523969,
            },
            {
              x: 362.3315947828733,
              y: 220.10188026084006,
            },
            {
              x: 364.9801528124511,
              y: 174.19354108149085,
            },
            {
              x: 425.01413481621546,
              y: 140.64513937350492,
            },
            {
              x: 441.7883356702085,
              y: 132.6994652847714,
            },
          ],
          label: 'balloon',
          order: 1,
          visible: true,
          tool: 'polygon',
        },
        {
          id: '8bb2af9e-a92b-4ad6-8432-991d51153331',
          type: 'spline',
          points: [
            {
              id: 'b5f77620-ceb4-460d-9bfe-28f8fae7d0a1',
              x: 304.94617080868676,
              y: 59.42269313311787,
            },
            {
              id: '7ed1a341-4651-4322-8fb6-7f0e1f8d8b59',
              x: 365.8630054889771,
              y: 77.07974666363678,
            },
            {
              id: '611004cc-3916-4347-a4b9-079cb97ab11d',
              x: 381.7543536664441,
              y: 127.40234922561572,
            },
            {
              id: 'f4177b68-7104-4197-9e7f-411c3c5590d1',
              x: 323.48607701573167,
              y: 213.92191152515844,
            },
            {
              id: '8cc0c188-f70f-49ed-bd33-4b74449309b0',
              x: 317.30610828005,
              y: 253.65028196882605,
            },
            {
              id: '784b2957-881e-48de-9847-633784999e95',
              x: 300.53190742605705,
              y: 253.65028196882605,
            },
            {
              id: 'fb58491e-6d83-440b-873d-229341fe62cc',
              x: 300.53190742605705,
              y: 237.75893379135903,
            },
            {
              id: '5fa3ccdc-e740-45eb-823f-cb749d8a9a60',
              x: 288.1719699546938,
              y: 212.15620617210655,
            },
            {
              id: '96091824-ab9d-4159-bbae-77222f8e077a',
              x: 232.5522513335592,
              y: 135.34802331434923,
            },
            {
              id: 'a6a94b90-2d73-4b60-a822-d8b642bb53c1',
              x: 246.67789415797432,
              y: 77.96259934016273,
            },
          ],
          controlPoints: [
            {
              x: 324.3689296922576,
              y: 58.539840456591875,
            },
            {
              x: 357.0344787237176,
              y: 67.36836722185139,
            },
            {
              x: 374.6915322542365,
              y: 86.79112610542218,
            },
            {
              x: 381.7543536664441,
              y: 97.38535822373358,
            },
            {
              x: 376.45723760728845,
              y: 162.71645628665354,
            },
            {
              x: 325.25178236878355,
              y: 211.2733534955806,
            },
            {
              x: 321.7203716626797,
              y: 216.5704695547363,
            },
            {
              x: 317.30610828005,
              y: 253.65028196882605,
            },
            {
              x: 317.30610828005,
              y: 253.65028196882605,
            },
            {
              x: 300.53190742605705,
              y: 253.65028196882605,
            },
            {
              x: 300.53190742605705,
              y: 253.65028196882605,
            },
            {
              x: 300.53190742605705,
              y: 237.75893379135903,
            },
            {
              x: 300.53190742605705,
              y: 237.75893379135903,
            },
            {
              x: 291.70338066079756,
              y: 216.5704695547363,
            },
            {
              x: 284.64055924858997,
              y: 207.7419427894768,
            },
            {
              x: 236.08366203966307,
              y: 152.1222241683422,
            },
            {
              x: 229.02084062745533,
              y: 118.57382246035627,
            },
            {
              x: 234.3179566866111,
              y: 86.79112610542218,
            },
            {
              x: 259.0378316293376,
              y: 69.13407257490327,
            },
            {
              x: 285.52341192511597,
              y: 60.30554580964387,
            },
          ],
          label: 'balloon',
          order: 2,
          visible: true,
          tool: 'polygon',
        },
        {
          id: 'b483f7f8-c11d-408b-939a-39412aea3bf4',
          type: 'spline',
          points: [
            {
              id: '88018372-112c-4b60-b2ea-c7c5177d965e',
              x: 213.1294924499883,
              y: 177.72495178759468,
            },
            {
              id: '79d3ba39-6dc4-4c02-a0cc-9aa37009115d',
              x: 259.0378316293376,
              y: 197.14771067116547,
            },
            {
              id: '3f2f75d3-1799-404f-b131-688f4bb0437b',
              x: 256.46097310528205,
              y: 234.34682347148217,
            },
            {
              id: '162a7869-f4af-41ed-8764-3c324bec29ea',
              x: 228.1617883912818,
              y: 269.4938801733558,
            },
            {
              id: 'e141fb2d-1eff-47db-a428-b0cb604c14fc',
              x: 220.73534534692374,
              y: 285.79182791386154,
            },
            {
              id: 'de108276-1cbc-4cf4-b244-222be9f959c7',
              x: 221.783351519773,
              y: 295.57321886045446,
            },
            {
              id: '1a6d82d9-bc5e-43e5-9c5e-a1fa5ad5d230',
              x: 212.00196057318,
              y: 296.62122503330363,
            },
            {
              id: '4104e427-bfc4-48d8-8952-90c8ed064ea4',
              x: 212.70063135507954,
              y: 286.3158310002861,
            },
            {
              id: '0195ecfe-22d1-4148-954b-8142cf4e4b92',
              x: 206.58726201345894,
              y: 273.2157538396706,
            },
            {
              id: '2b36b190-8c87-41df-84d2-d3d8a0e3b01c',
              x: 170.2083197211262,
              y: 225.0145951576686,
            },
            {
              id: '03b7739d-ca6f-4efa-b139-266f1527797b',
              x: 173.3977425689797,
              y: 191.62532471920315,
            },
          ],
          controlPoints: [
            {
              x: 233.43510401008515,
              y: 177.72495178759468,
            },
            {
              x: 252.85786289365595,
              y: 180.3735098171725,
            },
            {
              x: 265.2178003650192,
              y: 213.92191152515844,
            },
            {
              x: 262.4978410143844,
              y: 223.3946901944899,
            },
            {
              x: 250.06620403749886,
              y: 245.8954586796091,
            },
            {
              x: 228.1617883912818,
              y: 269.4938801733558,
            },
            {
              x: 228.1617883912818,
              y: 269.4938801733558,
            },
            {
              x: 220.73534534692374,
              y: 285.79182791386154,
            },
            {
              x: 220.73534534692374,
              y: 285.79182791386154,
            },
            {
              x: 221.783351519773,
              y: 295.57321886045446,
            },
            {
              x: 221.783351519773,
              y: 295.57321886045446,
            },
            {
              x: 212.00196057318,
              y: 296.62122503330363,
            },
            {
              x: 212.00196057318,
              y: 296.62122503330363,
            },
            {
              x: 212.70063135507954,
              y: 286.3158310002861,
            },
            {
              x: 212.70063135507954,
              y: 286.3158310002861,
            },
            {
              x: 206.58726201345894,
              y: 273.2157538396706,
            },
            {
              x: 206.58726201345894,
              y: 273.2157538396706,
            },
            {
              x: 172.40104792902554,
              y: 234.33369004124026,
            },
            {
              x: 168.01559151322706,
              y: 215.69550027409696,
            },
            {
              x: 168.46410410120646,
              y: 197.10714523895118,
            },
            {
              x: 178.33138103675293,
              y: 186.14350419945512,
            },
            {
              x: 192.82388088989146,
              y: 177.72495178759468,
            },
          ],
          label: 'balloon',
          order: 3,
          visible: true,
          tool: 'polygon',
        },
      ],
      cuboid: [],
      text: [],
      tag: [],
    },
  },
  {
    url: import.meta.env.BASE_URL + 'sample-3.jpg',
    name: 'sample-3',
    id: 'sample-3',
    meta: {
      width: 1280,
      height: 800,
      rotate: 0,
    },
    data: {
      line: [],
      point: [],
      rect: [],
      polygon: [
        {
          id: 'ea8e32c3-4a66-46dc-9ff6-35ca50241747',
          type: 'line',
          points: [
            {
              id: '84c18bd0-8075-452f-a02e-cf3361b1e74c',
              x: 476.5591397849462,
              y: 353.38172043010746,
            },
            {
              id: 'c9e9b461-f932-4a71-9347-0efc851b40de',
              x: 0,
              y: 260.4784946236559,
            },
            {
              id: '44023aa0-6cf2-4871-8b1e-f28b731a2bfc',
              x: 0,
              y: 0.6935483870967546,
            },
            {
              id: '4b6a236c-2b16-45f1-a25e-3b256f266bcc',
              x: 412.9032258064516,
              y: 0.6935483870967546,
            },
            {
              id: 'b2d83de6-1f36-46f8-bdac-d283f4e23605',
              x: 428.38709677419354,
              y: 21.338709677419335,
            },
            {
              id: '3c1d7521-29f7-42ba-acb7-b5cf3b7209c6',
              x: 454.1935483870967,
              y: 115.96236559139783,
            },
            {
              id: '045768af-fa6d-4136-8d4d-b68e44e97478',
              x: 510.96010152705617,
              y: 203.0291499127233,
            },
            {
              id: '93af448a-bbd5-4105-991e-26525131206b',
              x: 516.8778430497449,
              y: 222.2618098614617,
            },
            {
              id: 'ea7958b8-f33f-4804-9ebe-5a0904518c03',
              x: 535.2651113523848,
              y: 248.25760297898717,
            },
            {
              id: '8b3a2d7c-20c3-4644-8286-91416d213816',
              x: 527.4452386259748,
              y: 261.99521722808606,
            },
            {
              id: 'b9064024-9fdf-4aee-a652-8eba1ef9dbd5',
              x: 533.7856759717126,
              y: 285.24348749579167,
            },
            {
              id: '49599dad-6d29-451f-9d2d-4fe3c0391e0f',
              x: 510.7487536155316,
              y: 291.58392484152955,
            },
          ],
          label: 'building',
          order: 1,
          visible: true,
          tool: 'polygon',
        },
        {
          id: 'b309986c-0713-40eb-b3b2-2aa210bbfcd7',
          type: 'line',
          points: [
            {
              id: 'abce2386-5068-4d0f-a207-e2b436a51518',
              x: 0.26141020481562555,
              y: 408.634779956698,
            },
            {
              id: '87ad036e-fa12-473e-92e0-0058965d30e2',
              x: 66.07406427311332,
              y: 406.2269999298091,
            },
            {
              id: 'eef48d8c-8d55-41f7-9a50-4b706dc252ba',
              x: 72.49481101148385,
              y: 387.76735305699384,
            },
            {
              id: '639ef919-f5f9-45e6-b987-db8c6a4bacf6',
              x: 148.7411785296337,
              y: 387.76735305699384,
            },
            {
              id: '3cb80153-3f4d-4e82-ad6c-7751c75f299d',
              x: 156.7671119525968,
              y: 369.3077061841786,
            },
            {
              id: '215148fb-5689-4d52-9a17-2dcebb79451e',
              x: 170.41119877163416,
              y: 352.453245995956,
            },
            {
              id: '560c0571-1f66-4be8-91da-57bbe2bb02f6',
              x: 172.0163854562268,
              y: 338.80915917691874,
            },
            {
              id: '8e493d1b-3dfa-4ea7-ab16-42367e7885b5',
              x: 180.84491222148625,
              y: 319.54691896180714,
            },
            {
              id: '2770ea55-a4fc-4dd4-aefe-4b03a736ab84',
              x: 160.78007866407842,
              y: 309.1132055119551,
            },
            {
              id: 'd6db8755-ebea-4fd2-8f07-ca0b7de27039',
              x: 139.11005842207788,
              y: 293.06133866602875,
            },
            {
              id: 'a36dea63-3ee1-4d54-a3a2-e5e58aee01ff',
              x: 129.47893831452214,
              y: 292.2587453237325,
            },
            {
              id: 'aa11d417-98ef-407a-865e-16e8857c3bd3',
              x: 116.63744483778113,
              y: 284.2328119007694,
            },
            {
              id: '3839a662-bb78-4419-92ad-f08d4db31ce0',
              x: 0.26141020481562555,
              y: 261.76019831647255,
            },
          ],
          label: 'building',
          order: 2,
          visible: true,
          tool: 'polygon',
        },
        {
          id: 'f0cab0d9-0bfc-4a33-bc71-2dee5c5ab4da',
          type: 'line',
          points: [
            {
              id: 'a41b7163-1714-42b9-a460-f30f4202c8e2',
              x: 237.66189418880612,
              y: 541.3201439359317,
            },
            {
              id: 'bf68cde2-f588-4230-9d7c-20e43ca09e59',
              x: 267.7671704583408,
              y: 568.5120063729307,
            },
            {
              id: '6c07f0b6-6b97-45e7-b3c9-3d92f3710413',
              x: 254.17123923984133,
              y: 635.52052452125,
            },
            {
              id: '808a28b4-2a6a-4837-b754-63239a9ee4ae',
              x: -0.26690213493576037,
              y: 814.2099062501011,
            },
            {
              id: '9bfb5efd-f0b9-43c0-8eeb-e370b155a298',
              x: 0.7042358092427112,
              y: 618.0400415260362,
            },
            {
              id: 'fc4a8108-f040-49be-8f2e-ea98152fab1a',
              x: 106.55827172470346,
              y: 576.281109926359,
            },
          ],
          label: 'building',
          order: 3,
          visible: true,
          tool: 'polygon',
        },
        {
          id: '8475146d-aa52-41d4-8086-2a19416ebfde',
          type: 'line',
          points: [
            {
              id: '056d4377-595e-4559-bbe7-4484def7a8e1',
              x: 474.2708926813741,
              y: 493.422126918888,
            },
            {
              id: '1c69bfa2-20ca-45c8-9317-d627718b46af',
              x: 508.18752685487965,
              y: 513.4297649289387,
            },
            {
              id: 'ee553e9c-653c-4319-812f-2c55574f4cfd',
              x: 516.5422577409851,
              y: 504.7655995655702,
            },
            {
              id: '5e9fbbb4-3a58-451b-ad30-6f0eed7eaaed',
              x: 519.6366025136167,
              y: 506.00333747462275,
            },
            {
              id: 'afb723c1-c1b3-44c9-a3ff-0b52816977b3',
              x: 519.6366025136167,
              y: 510.33542015630707,
            },
            {
              id: 'd5e7c161-0ae0-42c3-844d-cd3807e34f84',
              x: 513.7573474456166,
              y: 516.2146752243071,
            },
            {
              id: 'e23bdb96-0250-4534-87c9-f82582e1145c',
              x: 543.4630572628802,
              y: 533.5430059510442,
            },
            {
              id: 'e2abab22-16ec-49e2-b9cb-1cf84d44e4d1',
              x: 547.1762709900381,
              y: 525.1882750649388,
            },
            {
              id: 'b12eae46-19e9-406a-bfe8-f6e87ac65ec6',
              x: 552.1272226262486,
              y: 523.3316682013599,
            },
            {
              id: 'e35e6f2c-d477-47a4-acc6-e3203b6f8b4a',
              x: 553.3649605353013,
              y: 527.0448819285178,
            },
            {
              id: '5192e371-e6f6-4bac-9702-52d918da4e52',
              x: 548.4140088990906,
              y: 536.0184817691495,
            },
            {
              id: 'def21207-d9f2-4f41-acf0-c7d38891fac3',
              x: 582.1423669207753,
              y: 554.8939848822024,
            },
            {
              id: '9b88480a-0668-4443-b697-3182a9e10ea8',
              x: 513.9811125393857,
              y: 853.9272420100307,
            },
            {
              id: '184c03b8-facc-4229-9293-663d05346eb5',
              x: 20.716306259988627,
              y: 853.3680752577419,
            },
          ],
          label: 'building',
          order: 4,
          visible: true,
          tool: 'polygon',
        },
        {
          id: 'c3593c69-782f-4071-97b9-f6d2d6c01560',
          type: 'line',
          points: [
            {
              id: '2b6e8394-01a1-4d56-8236-adb42bbe9492',
              x: 173.44981929897654,
              y: 692.6888881300206,
            },
            {
              id: '33620fec-ebd4-4cde-8520-85651a50d5ff',
              x: 182.27834606423588,
              y: 700.634562218754,
            },
            {
              id: 'a0734ecf-99ea-420e-af54-e9f8762b22df',
              x: 175.2155246520283,
              y: 730.651553220636,
            },
            {
              id: '05706801-3dd0-41fa-b4c9-ec546bb448f6',
              x: 18.950600906936735,
              y: 854.2509279342678,
            },
            {
              id: 'e130bc2d-75b2-4a03-95e4-ca491e6fd826',
              x: -0.4721579766339678,
              y: 853.3680752577419,
            },
            {
              id: 'd6211608-b1e6-4852-b777-62027ccb4079',
              x: -0.4721579766339678,
              y: 814.5225574906004,
            },
          ],
          label: 'building',
          order: 5,
          visible: true,
          tool: 'polygon',
        },
        {
          id: '42466316-e1e3-431d-9e0a-79d531276f0b',
          type: 'line',
          points: [
            {
              id: '4ad1dcfe-9cb7-4db4-ac6c-0c2a08864b24',
              x: 853.8829640558077,
              y: 203.1110451062726,
            },
            {
              id: 'f44f63e5-39f7-4afd-a3f3-1dfa5aaed0d8',
              x: 887.580378629766,
              y: 225.57598815557816,
            },
            {
              id: 'f302bc5b-f139-4c72-887c-099256d9beec',
              x: 889.6226461797028,
              y: 225.2356102305886,
            },
            {
              id: '7e243770-8411-4669-9300-a399b57a9124',
              x: 903.237763179282,
              y: 233.40468043033607,
            },
            {
              id: 'ce809281-980e-46d0-8b55-50950bfc02e0',
              x: 917.2259276024076,
              y: 230.75528938262966,
            },
            {
              id: '87625a21-d244-406f-b3f7-5dd4c374bda9',
              x: 1280.6454286114988,
              y: 54.58184391708254,
            },
            {
              id: 'ff1bbe36-d4f1-4aad-a4db-c5238079cf5b',
              x: 1279.5490645075492,
              y: -0.2363612803978329,
            },
            {
              id: 'e2da95f6-d7b3-46a6-be2b-e1f89b0862ea',
              x: 1016.4216795596438,
              y: -0.2363612803978329,
            },
            {
              id: '860d2c6e-1fba-4f35-8fa7-3a117e2beb15',
              x: 1006.0062205721226,
              y: 7.438187447249474,
            },
            {
              id: 'a60b6079-da2d-4098-a447-6e4afbe60cfe',
              x: 998.3316718444753,
              y: 23.335466954518797,
            },
            {
              id: 'a33b0794-4988-404f-8857-4e1ebbc64324',
              x: 886.5025332416155,
              y: 128.03823888170598,
            },
            {
              id: '8acb0fae-fa47-4c8c-ae0a-d6c564d7cba8',
              x: 876.635256306069,
              y: 144.4837004409502,
            },
            {
              id: '69aef3aa-3ec6-41cb-bfca-84518767666b',
              x: 879.9243486179181,
              y: 148.86915685674856,
            },
            {
              id: '54fd3f90-47b7-4353-80de-07cc85219840',
              x: 861.8343409027495,
              y: 165.86280046796742,
            },
            {
              id: '100b3ab2-70f0-42f3-bee1-5e5499215739',
              x: 850.8706998632533,
              y: 180.6637158712871,
            },
          ],
          label: 'building',
          order: 6,
          visible: true,
          tool: 'polygon',
        },
        {
          id: 'c6b47eda-205d-4e72-b2ad-1d7bab42827f',
          type: 'line',
          points: [
            {
              id: '7b09bf28-8a53-4b53-8572-516bacca821f',
              x: 1279.696619999784,
              y: 329.30710884657327,
            },
            {
              id: 'e493ebc5-f620-4bb4-87aa-e1304e92874c',
              x: 984.5279941139522,
              y: 350.53271789903755,
            },
            {
              id: '947eac10-660b-4590-9ef4-c75541c9c7d3',
              x: 976.5683907192781,
              y: 379.71793034617593,
            },
            {
              id: '2268dcb9-cdcb-4d23-8770-eedb9312a298',
              x: 948.7097788379187,
              y: 379.71793034617593,
            },
            {
              id: 'db891383-b8ca-4a7f-9c46-2f4631dc8978',
              x: 916.2080649763327,
              y: 434.77185382600516,
            },
            {
              id: '704765dd-5898-4caa-bc82-13b0d3a00d33',
              x: 898.9622576212057,
              y: 473.2432702335968,
            },
            {
              id: 'f1d786fb-0850-4306-a532-6780e4aae9f0',
              x: 890.339353943642,
              y: 513.0412872069674,
            },
            {
              id: '4328e277-ca4f-4da6-bc9f-d6b3fb07a412',
              x: 887.6861528120838,
              y: 544.2164005027743,
            },
            {
              id: '4702bd1e-431c-43c9-9b80-74d1e4cc0469',
              x: 1162.2924699283408,
              y: 689.4791624555768,
            },
            {
              id: '0211d2c8-0352-46d2-abf0-2a996d5d37dc',
              x: 1189.4877815268105,
              y: 672.2333551004496,
            },
            {
              id: '3bb0186e-2861-4e6d-aabe-20744ad0bc2c',
              x: 1241.2252035921924,
              y: 700.0919669818089,
            },
            {
              id: 'da3bd3ad-05d1-4a02-9ac1-be8cbe3f9914',
              x: 1279.696619999784,
              y: 686.1626610411292,
            },
          ],
          label: 'building',
          order: 7,
          visible: true,
          tool: 'polygon',
        },
        {
          id: '753171e8-ddfc-4557-8d94-8b0b8a69fab3',
          type: 'line',
          points: [
            {
              id: '47531757-ed92-4f01-9617-205dc511751d',
              x: 1108.5651470142905,
              y: 852.6510320463959,
            },
            {
              id: 'ef93071e-9593-4b20-abe1-7ca49c66a767',
              x: 1099.9422433367267,
              y: 844.0281283688324,
            },
            {
              id: 'fad735f5-6f90-4dda-ab6f-673b850cfeb4',
              x: 1103.922045034064,
              y: 839.3850263886058,
            },
            {
              id: 'a0a7375a-6da6-4b7d-90b9-96b301bf44f9',
              x: 1107.901846731401,
              y: 844.6914286517219,
            },
            {
              id: 'eb7f6b31-0b70-4c46-bd12-1ddd5fb681bc',
              x: 1104.5853453169534,
              y: 825.4557204479262,
            },
            {
              id: '161d118c-7ba4-4d4f-891b-2e041a686e8e',
              x: 1088.0028382447158,
              y: 812.1897147901361,
            },
            {
              id: '5902c99e-8d97-4d7b-8a91-816e817027ea',
              x: 1091.3193396591632,
              y: 804.8934116783515,
            },
            {
              id: '33e4f5d1-aa21-4024-aa2c-d24db70bbb16',
              x: 1099.9422433367267,
              y: 812.8530150730254,
            },
            {
              id: '52d5e995-efc9-42a7-a27d-fcb40163693e',
              x: 1094.635841073611,
              y: 790.3008054547823,
            },
            {
              id: 'd5bfc8c2-597a-4bc8-9ac3-fca6461f213e',
              x: 1082.6964359815997,
              y: 781.014601494329,
            },
            {
              id: '6febc910-6697-417e-ae58-ca26d6683bec',
              x: 1085.3496371131575,
              y: 776.3714995141024,
            },
            {
              id: '0ecb90ed-654f-4a9c-9506-b0bfa1336210',
              x: 1093.9725407907213,
              y: 782.3412020601081,
            },
            {
              id: '26d5b9fe-93dd-4c3f-9cff-df970d8273a9',
              x: 1089.9927390933842,
              y: 773.0549980996549,
            },
            {
              id: '6ca1bb88-9f65-488d-a693-8d55fe177bb6',
              x: 1078.053334001373,
              y: 763.7687941392019,
            },
            {
              id: 'ec0f4646-e2f3-4739-8986-790a350af8f7',
              x: 1081.3698354158205,
              y: 760.4522927247543,
            },
            {
              id: '79c3b020-00cf-475e-ad05-d3ad0e503de0',
              x: 1087.3395379618262,
              y: 761.1155930076436,
            },
            {
              id: 'a81aca83-6274-485c-b15e-caad7de2c059',
              x: 1083.3597362644891,
              y: 753.819289895859,
            },
            {
              id: 'd7b6e665-5ea6-4809-86ac-27ce5bea0e65',
              x: 1096.6257419222795,
              y: 747.8495873498536,
            },
            {
              id: '2411a90a-e04f-4904-b3d6-4c666c2ca2f1',
              x: 1088.0028382447158,
              y: 728.6138791460578,
            },
            {
              id: '30ec160d-8025-4c55-ab8d-c72112bcd1df',
              x: 1092.6459402249423,
              y: 718.6643749027152,
            },
            {
              id: 'e3c1ce54-b851-454b-862d-54495c0ba2a9',
              x: 1190.1510818097001,
              y: 672.8966553833391,
            },
            {
              id: 'cda5f7a8-7d28-4751-b542-618e4c2f25df',
              x: 1241.2252035921924,
              y: 700.0919669818089,
            },
            {
              id: '4c55025a-73bb-4905-bf88-15a5aa248efe',
              x: 1279.0333197168943,
              y: 687.4892616069083,
            },
            {
              id: '31326a22-936c-49a8-9cc5-bb29b470e41b',
              x: 1280.3599202826736,
              y: 853.3143323292857,
            },
          ],
          label: 'building',
          order: 8,
          visible: true,
          tool: 'polygon',
        },
        {
          id: 'f8779d64-f55f-46b2-bfbd-a886968eff2f',
          type: 'line',
          points: [
            {
              id: '7a5785a3-834a-4656-bf6b-dbbc676d7443',
              x: 885.0329516805259,
              y: 635.7518395415265,
            },
            {
              id: 'bdf5ca5c-3ab8-41d8-93a0-0d62a1a0f025',
              x: 806.1002180166743,
              y: 674.2232559491181,
            },
            {
              id: '2b347bd1-8ce1-4d7c-99e2-d73e4f637b1d',
              x: 916.2080649763327,
              y: 856.6308337437332,
            },
            {
              id: 'fa329cd4-3553-4c49-90aa-88f13d9106a3',
              x: 1106.5752461656218,
              y: 853.9776326121753,
            },
            {
              id: 'f07d093d-89a0-4d15-9026-e56ea77266d5',
              x: 1099.9422433367267,
              y: 848.6712303490591,
            },
            {
              id: '980f538a-61bf-4831-add6-0db9b6b9cf3e',
              x: 1097.289042205169,
              y: 848.6712303490591,
            },
            {
              id: 'be7e465c-97d6-443b-87d7-8bf415e18dd5',
              x: 1088.6661385276052,
              y: 834.7419244083792,
            },
            {
              id: '9f242079-cac5-4c40-8f02-7e6610f84188',
              x: 1076.726733435594,
              y: 822.1392190334786,
            },
            {
              id: 'ff146cc3-4d16-4b0d-8fa1-a6bad8fa0d45',
              x: 1072.746931738257,
              y: 825.4557204479262,
            },
            {
              id: '10f4ef6e-90f0-438f-82ff-ffe3768e685e',
              x: 1064.7873283435829,
              y: 812.8530150730254,
            },
            {
              id: 'e71f140a-a38a-41e3-af55-de885349f690',
              x: 1054.1745238173507,
              y: 801.5769102639038,
            },
            {
              id: 'e164d76f-0c69-48a1-b150-fd2c48309d86',
              x: 1050.1947221200137,
              y: 802.9035108296828,
            },
            {
              id: '742f3234-dd30-498a-bad0-230ddb6f6a78',
              x: 1043.5617192911186,
              y: 790.9641057376716,
            },
            {
              id: 'fe633cab-a209-42d2-820b-fdc32f4e7bfc',
              x: 1032.9489147648865,
              y: 781.014601494329,
            },
            {
              id: 'b6018813-5203-4ce0-8c4b-e52932fc6437',
              x: 1028.9691130675494,
              y: 782.3412020601081,
            },
            {
              id: 'fca922df-94e9-41b3-865b-3942227871f5',
              x: 1023.6627108044332,
              y: 771.0650972509865,
            },
            {
              id: '5b5b28a5-879b-4a8d-8c8b-2badc5271523',
              x: 1013.7132065610906,
              y: 761.7788932905332,
            },
            {
              id: 'ea29e110-4754-4be5-8443-a142d3261d20',
              x: 1011.0600054295327,
              y: 763.1054938563124,
            },
            {
              id: '6ee48a4f-4564-4477-8f0c-184a53c6ceb0',
              x: 1005.0903028835271,
              y: 754.4825901787486,
            },
            {
              id: 'b7e9e7a0-918c-4b77-a202-b20ee41bd44c',
              x: 997.130699488853,
              y: 745.1963862182956,
            },
            {
              id: '50d31dd9-296e-44ad-9be3-547f291ab24c',
              x: 993.8141980744055,
              y: 745.1963862182956,
            },
            {
              id: 'dd0ceafb-7ffe-4978-952e-3a0feec564cb',
              x: 988.5077958112893,
              y: 736.5734825407319,
            },
            {
              id: 'c95cf974-9307-498d-8954-01a30d8e5d5a',
              x: 980.1530649251844,
              y: 728.483754803527,
            },
            {
              id: 'ac64f5c9-79cd-47fd-b86e-7b5d57a785d2',
              x: 977.677589107079,
              y: 728.79318928079,
            },
            {
              id: 'd8dd7d10-72fd-4027-af51-ad65876e881c',
              x: 972.7266374708685,
              y: 721.6761963037374,
            },
            {
              id: '2664816e-2157-4989-83e1-37485be8d183',
              x: 965.3002100165526,
              y: 713.321465417632,
            },
            {
              id: '6af35944-0f54-4d1e-8321-e342a3509a90',
              x: 962.2058652439209,
              y: 713.9403343721583,
            },
            {
              id: '52913f2e-992e-45d0-909f-bf8bd465867f',
              x: 958.4926515167631,
              y: 707.7516448268951,
            },
            {
              id: 'e74fca48-8913-419d-b346-ac2342e0d7ed',
              x: 951.0662240624473,
              y: 700.3252173725792,
            },
            {
              id: '75228beb-53fd-43b6-b187-5185dd18d5f1',
              x: 948.590748244342,
              y: 700.3252173725792,
            },
            {
              id: 'e861b46d-0e39-430b-90d2-bed42af90b88',
              x: 944.8775345171841,
              y: 695.0648312591056,
            },
            {
              id: '8d7ef138-d36b-4d30-b11a-06ca4fc9bcd3',
              x: 938.998279449184,
              y: 687.9478382820529,
            },
            {
              id: '380ce8de-8779-44a3-a6bf-29bc3562bf60',
              x: 935.5945001992892,
              y: 688.257272759316,
            },
            {
              id: 'f8e12eb1-bd7d-4c82-9afd-5017936d80a5',
              x: 933.1190243811839,
              y: 682.378017691316,
            },
            {
              id: 'a78fd6b8-2070-40c0-aecc-c51ad2ab08a6',
              x: 926.9303348359208,
              y: 675.2610247142633,
            },
            {
              id: 'e90937f7-e56e-4db5-8a24-d3103f0738c3',
              x: 924.7642934950786,
              y: 676.1893281460527,
            },
            {
              id: '37a835fb-e0a8-4745-923f-72238e3b88ee',
              x: 921.669948722447,
              y: 670.619507555316,
            },
            {
              id: '15b22919-025a-4a46-a470-922be000eb56',
              x: 916.1001281317102,
              y: 664.7402524873158,
            },
            {
              id: 'a0d77222-ddc5-4154-af5f-d4cafe985d11',
              x: 914.2435212681313,
              y: 665.3591214418423,
            },
            {
              id: '18b5240f-14b7-4d3b-8205-5142476744a9',
              x: 910.8397420182365,
              y: 660.0987353283685,
            },
            {
              id: '3ec9e20c-00f4-4e8e-a61d-ab43ddea5122',
              x: 906.8170938138154,
              y: 655.1477836921579,
            },
            {
              id: 'ca0f92bc-06dd-4482-b641-fc1c58358462',
              x: 903.4133145639206,
              y: 655.4572181694211,
            },
            {
              id: 'bf43a795-7326-4c9c-9b66-61eff2ed455c',
              x: 901.5567077003417,
              y: 651.1251354877368,
            },
          ],
          label: 'building',
          order: 9,
          visible: true,
          tool: 'polygon',
        },
        {
          id: '1dea6090-402c-465d-bb6b-dec756786260',
          type: 'line',
          points: [
            {
              id: '29279efe-bf7d-4d45-b29d-ed3278dfe16a',
              x: 582.5701384897097,
              y: 853.9825553778919,
            },
            {
              id: 'c463f28d-3b19-4d06-9993-d0b677996de8',
              x: 609.5969074761982,
              y: 517.9105584154696,
            },
            {
              id: '9e968904-290f-4ba2-84c8-fa5818fc4754',
              x: 615.2229888809828,
              y: 517.1433654966355,
            },
            {
              id: 'c442fb4f-8a18-4894-a7d6-a347514d2a8f',
              x: 617.7802986104305,
              y: 501.7995071199499,
            },
            {
              id: 'f6328dd7-dc65-4076-9cb4-d77ccac61f02',
              x: 624.1735729340494,
              y: 489.2686894456566,
            },
            {
              id: '813dfcc3-e6c1-4045-9358-c0456734cc2e',
              x: 641.5632790942931,
              y: 472.39044523130246,
            },
            {
              id: '231671da-62d2-46f4-b9ca-d8edbddaf217',
              x: 658.4415233086472,
              y: 465.9971709076835,
            },
            {
              id: '65d92003-8fa9-4f41-9721-7d5d92d5ab44',
              x: 680.6901179548414,
              y: 467.0200947994625,
            },
            {
              id: 'fff4bd3b-b090-4118-bfaa-e4338c7d5321',
              x: 695.7782453585822,
              y: 473.6691000960263,
            },
            {
              id: 'c7b72175-8d50-47a6-800b-bbfba0f7be13',
              x: 708.0533320599307,
              y: 483.89833901381667,
            },
            {
              id: '870bb3b2-02c2-454e-8375-62f762fbce32',
              x: 717.5153780588868,
              y: 495.40623279633087,
            },
            {
              id: 'fb3129a8-e1d4-4935-a4a7-48b834bba47d',
              x: 730.3019267061247,
              y: 552.9457017089018,
            },
            {
              id: 'd68d2aeb-f246-4aa0-a71f-81d1af426695',
              x: 911.8788111225095,
              y: 854.4840091480687,
            },
          ],
          label: 'building',
          order: 10,
          visible: true,
          tool: 'polygon',
        },
        {
          id: '8d9453de-500b-44ad-8c77-97f71ff2c747',
          type: 'line',
          points: [
            {
              id: 'd5fb848b-73f4-485c-a919-60e9e048b424',
              x: 530.9709845492323,
              y: 403.0417591911026,
            },
            {
              id: 'c3a94b71-724e-4c4a-b731-c9b84c2b1735',
              x: 528.2715747100751,
              y: 395.5786849299035,
            },
            {
              id: '95358227-7cd8-46d5-85fd-162f96506301',
              x: 511.7575380469962,
              y: 375.57129435732696,
            },
            {
              id: 'aefe031e-5c44-4ad4-a4e6-2a6f6b71c355',
              x: 510.1696499063155,
              y: 372.87188451816985,
            },
            {
              id: '5c932329-1a47-4536-895d-6a793024e79e',
              x: 512.0751156751323,
              y: 371.76036281969334,
            },
            {
              id: '5c7de796-5189-45c6-b4dd-b44ae2e739d3',
              x: 514.7745255142895,
              y: 372.23672926189755,
            },
            {
              id: '8d252f3e-fcce-4687-998c-2cd870d72e43',
              x: 536.0522265994105,
              y: 389.22713236718073,
            },
            {
              id: 'a4f24d48-f177-4aff-af4f-7a1773375e4c',
              x: 541.927412719929,
              y: 385.8925672717513,
            },
            {
              id: '27d3a4ee-be1c-4add-92d4-0ed1d745fce9',
              x: 545.2619778153584,
              y: 387.480455412432,
            },
            {
              id: '469440f9-d8fa-42c3-95b7-d3948494b148',
              x: 545.8971330716306,
              y: 389.5447099953169,
            },
            {
              id: 'ec6d3828-30f3-4ca5-9be6-f3bb213e904f',
              x: 540.6571022073844,
              y: 391.6089645782018,
            },
            {
              id: '87ca914e-d8c0-402b-a475-df8bfd27b3fb',
              x: 540.6571022073844,
              y: 393.35564153295053,
            },
            {
              id: '8ca43bbb-490e-4126-8d1f-e65314d58d34',
              x: 546.3734995138349,
              y: 397.3253618846521,
            },
            {
              id: '3d72eb90-c313-43bd-b95d-b1ff9d25ff2e',
              x: 563.5226914331861,
              y: 389.70349880938494,
            },
            {
              id: 'cb96b140-e4b9-4f7c-bf6b-bb80831f6099',
              x: 570.9857656943852,
              y: 388.5919771109085,
            },
            {
              id: '9a992228-7027-47a5-8a67-80b326242252',
              x: 574.4791196038827,
              y: 390.33865406565724,
            },
            {
              id: '2aa544ef-acb2-4911-982d-b10fafd5e222',
              x: 571.9384985787935,
              y: 393.03806390481435,
            },
            {
              id: '4862ae12-1806-493d-b152-0c58d25ba4dc',
              x: 567.3336229708198,
              y: 397.80172832685633,
            },
            {
              id: '63d0d1f6-9470-4de4-baac-c45534e2454a',
              x: 550.0256422374003,
              y: 404.15328088957904,
            },
            {
              id: 'ba162c00-8d9b-469a-86c4-047b11881345',
              x: 547.8025988404474,
              y: 412.2515104070505,
            },
            {
              id: 'a3ff5e4a-36bf-4a79-9392-17e1ea0edd51',
              x: 552.8838408906255,
              y: 411.45756633671016,
            },
            {
              id: 'e7bcb55d-57ae-4054-9393-265df34fb9c3',
              x: 554.7893066594423,
              y: 412.4102992211186,
            },
            {
              id: 'a92d7361-a9a3-4c3c-a888-6e08d999d455',
              x: 554.4717290313062,
              y: 414.9509202462076,
            },
            {
              id: 'f46c4708-9b0e-42c9-859f-1c0b1c131fa9',
              x: 547.0086547701071,
              y: 417.8091188994328,
            },
            {
              id: '21d2b6b9-0cf0-4117-b658-356efa803b12',
              x: 541.7686239058609,
              y: 449.090515270842,
            },
            {
              id: '7c726f6b-43a6-4c11-93d8-61096d31e25f',
              x: 540.1807357651802,
              y: 450.3608257833866,
            },
            {
              id: 'd7c6e2e9-6371-43db-9fbd-caccbaf0ef6a',
              x: 538.4340588104315,
              y: 447.50262713016133,
            },
            {
              id: 'c2d8b45e-7fd5-4e59-8d97-147c3aa84f6b',
              x: 537.481325926023,
              y: 419.55579585418155,
            },
            {
              id: '13eb4e0c-01ab-4228-92fb-37afbc37f4f4',
              x: 534.3055496446617,
              y: 411.93393277891437,
            },
            {
              id: 'ac21e930-4c7f-4739-a5aa-9c5a7f28b5e3',
              x: 508.74055057970287,
              y: 420.8261063667261,
            },
            {
              id: '8b7a7857-3b15-4a05-9501-b3c7883056b2',
              x: 505.88235192647767,
              y: 434.3231555625118,
            },
            {
              id: '0190bb05-3d93-4e02-8bf0-5e9d6bb488fa',
              x: 504.1356749717289,
              y: 434.48194437657986,
            },
            {
              id: '78e6ff92-3826-4d9f-a964-a85f5a847ad3',
              x: 502.5477868310483,
              y: 422.57278332147484,
            },
            {
              id: '763f6f3f-0765-400d-9902-addc8a23b7d2',
              x: 501.11868750443574,
              y: 419.07942941197734,
            },
            {
              id: '592c44d6-384b-4da3-ac83-ac703123a91b',
              x: 496.0374454542575,
              y: 411.45756633671016,
            },
            {
              id: '5e32ffee-b36d-4f89-83e3-70d714022224',
              x: 495.4022901979853,
              y: 408.9169453116211,
            },
            {
              id: 'b62096f9-c017-438f-a8dc-d0f92f6b61b7',
              x: 496.99017833866594,
              y: 407.96421242721266,
            },
            {
              id: '2e3bfc4b-b07e-4bde-97b2-1d77fb222618',
              x: 506.9938736249541,
              y: 416.06244194468405,
            },
            {
              id: '6479760d-69d9-44ae-9c3f-d2f8abe28da9',
              x: 519.5381899363315,
              y: 408.44057886941687,
            },
          ],
          label: 'airplane',
          order: 11,
          visible: true,
          tool: 'polygon',
        },
      ],
      cuboid: [],
      text: [],
      tag: [],
    },
  },
  {
    url: import.meta.env.BASE_URL + 'sample-4.jpg',
    name: 'sample-4',
    id: 'sample-4',
    meta: {
      width: 1280,
      height: 800,
      rotate: 0,
    },
    data: {
      line: [],
      point: [
        {
          order: 7,
          id: '1ab272c4-b8dc-46e0-aae6-17c211c922e7',
          label: 'glass',
          x: 561.7716484094965,
          y: 167.61024134594956,
          tool: 'point',
        },
        {
          order: 8,
          id: '0299866b-2c7e-4bb5-b394-f753cd815566',
          label: 'glass',
          x: 530.645865075874,
          y: 171.64506511141914,
          tool: 'point',
        },
        {
          order: 9,
          id: '1ed0d7b8-d731-4156-9f4f-0cef98fe238b',
          label: 'glass',
          x: 703.6358242856392,
          y: 203.7364441966062,
          tool: 'point',
        },
        {
          order: 10,
          id: '068d9457-37b3-4704-adc7-104c6df28277',
          label: 'glass',
          x: 731.7170030972711,
          y: 193.62721982441866,
          tool: 'point',
        },
        {
          order: 11,
          id: '3eb0675a-cac9-48ce-b2be-a0ccd1f9c1b9',
          label: 'glass',
          x: 875.8670543303155,
          y: 235.18736446563403,
          tool: 'point',
        },
        {
          order: 12,
          id: '16d76a07-1889-4422-aa02-f4efaff99967',
          label: 'glass',
          x: 904.6970645769244,
          y: 231.0687915732613,
          tool: 'point',
        },
        {
          order: 13,
          id: 'f4a0388e-1491-4670-8ff8-fe08f8aadb16',
          label: 'glass',
          x: 1000.5474882539617,
          y: 263.64295899475445,
          tool: 'point',
        },
      ],
      rect: [
        {
          id: '7feb1969-e490-4845-b727-aae2206ec20c',
          x: 495.4838709677419,
          y: 84.15591397849462,
          label: 'helmet',
          width: 92.9032258064516,
          height: 77.41935483870967,
          order: 1,
          tool: 'rect',
        },
        {
          id: '659a6409-7566-4d45-bcca-b9248ac40229',
          x: 650.3225806451612,
          y: 115.1236559139785,
          label: 'helmet',
          width: 101.50537634408602,
          height: 70.53763440860214,
          order: 2,
          tool: 'rect',
        },
        {
          id: '82f0dae7-9035-47e9-91e7-dfc6d0a3b1c0',
          x: 807.4151717985369,
          y: 171.2216850195787,
          label: 'helmet',
          width: 46.34630075787001,
          height: 44.85125879793872,
          order: 3,
          tool: 'rect',
        },
        {
          id: '30020ce9-f973-4bf8-a9be-546675acdc22',
          x: 845.7879154367733,
          y: 160.25804398008262,
          label: 'helmet',
          width: 78.73887655638138,
          height: 61.2967203571829,
          order: 4,
          tool: 'rect',
        },
        {
          id: '983b7c2b-84dc-48ce-bda4-b10df12857a5',
          x: 747.6134934012853,
          y: 147.30101366067808,
          label: 'helmet',
          width: 32.39257579851128,
          height: 19.435545479106757,
          order: 5,
          tool: 'rect',
        },
        {
          id: '519b3ca7-4b87-4475-93b6-0416e25d5f3b',
          x: 954.4276311917805,
          y: 203.61426081809003,
          label: 'helmet',
          width: 59.303331077274485,
          height: 44.85125879793872,
          order: 6,
          tool: 'rect',
        },
      ],
      polygon: [],
      cuboid: [],
      text: [],
      tag: [],
    },
  },
];

const defaultConfig = {
  point: { maxPointAmount: 100, labels: [{ color: '#1899fb', key: 'Glass', value: 'glass' }] },
  line: {
    lineType: 'line',
    minPointAmount: 2,
    maxPointAmount: 100,
    edgeAdsorptive: false,
    labels: [{ color: '#ff0000', key: 'Lane', value: 'lane' }],
  },
  rect: { minWidth: 1, minHeight: 1, labels: [{ color: '#00ff1e', key: 'Helmet', value: 'helmet' }] },
  polygon: {
    lineType: 'line',
    minPointAmount: 2,
    maxPointAmount: 100,
    edgeAdsorptive: false,
    labels: [
      { color: '#ff6600', key: 'Building', value: 'building' },
      { color: '#00ffc8', key: 'Airplane', value: 'airplane' },
      { color: '#8400ff', key: 'Balloon', value: 'balloon' },
    ],
  },
  cuboid: {
    labels: [
      { color: '#ff00d0', key: 'SUV', value: 'suv' },
      { color: '#ff6d2e', key: 'Car', value: 'car' },
    ],
  },
};

export default function ImagePage() {
  const annotatorRef = useRef<AnnotatorRef>(null);
  const [configOpen, setConfigOpen] = useState(false);
  const [resultOpen, setResultOpen] = useState(false);
  const [config, setConfig] = useState(defaultConfig);
  const [currentSample, updateSample] = useState(presetSamples[0]);
  const [result, setResult] = useState<any>({});
  const [form] = Form.useForm();

  const showDrawer = useCallback(() => {
    setConfigOpen(true);
  }, []);

  const onClose = () => {
    form.validateFields().then(() => {
      setConfigOpen(false);
      form.submit();
    });
  };

  const onFinish = (values: any) => {
    setConfig(values.tools);
  };

  const items: TabsProps['items'] = TOOL_NAMES.map((item) => ({
    key: item,
    label: item,
    forceRender: true,
    children: <FancyForm template={templateMapping[item]} name={['tools', item]} />,
  }));

  const onError = useCallback((err: any) => {
    message.error(err.message);
  }, []);

  const onLoad = useCallback((engine: Annotator) => {
    const updateSampleData = () => {
      setResult(() => ({
        ...annotatorRef.current?.getAnnotations(),
        ...annotatorRef.current?.getGlobalAnnotations(),
      }));
    };
    engine.on('add', updateSampleData);

    engine.on('change', updateSampleData);

    engine.on('labelChange', updateSampleData);
  }, []);

  const showResult = useCallback(() => {
    const imageAnnotations = annotatorRef.current?.getAnnotations();
    const globalAnnotations = annotatorRef.current?.getGlobalAnnotations();

    setResult(() => ({
      ...imageAnnotations,
      ...globalAnnotations,
    }));

    setResultOpen(true);
  }, []);

  const onOk = () => {
    setResultOpen(false);
    // 复制到剪切板
    navigator.clipboard.writeText(JSON.stringify(currentSample.data, null, 2));
    message.success('复制成功');
  };

  const toolbarRight = useMemo(() => {
    return (
      <div className="flex items-center gap-2">
        <Button type="primary" icon={<CodeOutlined rev={undefined} />} onClick={showResult}>
          标注结果
        </Button>
        <Button icon={<SettingOutlined rev={undefined} />} onClick={showDrawer} />
      </div>
    );
  }, [showDrawer, showResult]);

  return (
    <>
      <ImageAnnotator
        toolbarRight={toolbarRight}
        samples={presetSamples}
        ref={annotatorRef}
        offsetTop={148}
        editingSample={currentSample}
        config={config}
        onLoad={onLoad}
        onError={onError}
      />
      <Drawer width={480} title="工具配置" onClose={onClose} open={configOpen}>
        <Form
          form={form}
          layout="vertical"
          onFinish={onFinish}
          initialValues={{
            tools: defaultConfig,
          }}
        >
          <Tabs items={items} />
        </Form>
      </Drawer>
      <Modal
        title="标注结果"
        open={resultOpen}
        onOk={onOk}
        width={800}
        okText="复制"
        onCancel={() => setResultOpen(false)}
      >
        <CodeMirror value={JSON.stringify(result, null, 2)} extensions={[json()]} />
      </Modal>
    </>
  );
}
